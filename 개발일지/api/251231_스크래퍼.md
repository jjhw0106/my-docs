# 📅 2025년 12월 31일 작업 리포트 (With GEMINI)

## 📝 개요 (Summary)
금일 작업은 **NestJS와 Playwright를 활용한 독립 스크래핑 마이크로서비스 구축**을 목표로 진행되었습니다. 브라우저 보안 정책(CORS)을 준수하면서도, 잡코리아의 복잡한 팝업 구조와 페이지네이션을 처리할 수 있는 고성능 자동화 로직을 완성했습니다.

---

## 🏗 1. 스크래퍼 서버 아키텍처 (NestJS Service)

### 🛠 기술 스택 및 초기 설정
* **Core**: NestJS (TypeScript)
* **Engine**: Playwright (Chromium)
* **Hot Reload**: `npm run start:dev` 환경 구성으로 개발 생산성 증대.
* **CORS**: 프론트엔드(Nuxt) 연동을 위한 전역 허용 및 4000번 포트 할당.

---

## 🤖 2. 잡코리아 스크래핑 로직 고도화

### 🚀 핵심 구현 기술
1. **듀얼 로그인 시스템**:
   - **자동 모드**: 프론트에서 전달받은 ID/PW를 이용해 봇이 직접 필드 입력 및 엔터 수행.
   - **수동 모드**: 캡챠나 보안 이슈 발생 시, 사용자가 직접 로그인할 때까지 최대 2분간 브라우저 대기 및 성공 감지.
2. **범용 팝업/백드롭 제거 (`removePopups`)**:
   - 페이지네이션 클릭 시 방해가 되는 모든 레이어 팝업과 투명/회색 배경(Backdrop)을 DOM에서 강제로 삭제하여 클릭 차단 문제 해결.
3. **지능형 데이터 필터링**:
   - `tbody tr` 전체 탐색 중 "유사한 추천공고" 행을 텍스트 기반으로 자동 제외.
   - 회사명, 공고명, 상태값이 모두 존재하는 순수 지원 내역만 추출하여 데이터 정합성 확보.
4. **페이지네이션 자동화**:
   - `MAX_PAGES` 설정을 통한 무한 루프 방지 및 최대 5페이지 분량의 과거 데이터 일괄 수집 지원.

---

## 📂 변경된 파일 목록 (File Changes)

```text
scraper-server/
├── src/
│   ├── scraper/
│   │   ├── scraper.controller.ts # [신규] POST /scraper/:platform 엔드포인트
│   │   └── scraper.service.ts    # [신규] Playwright 핵심 로직 (팝업 제거, 페이지네이션)
│   ├── main.ts                   # [수정] 포트 설정 및 CORS 활성화
│   └── app.module.ts             # [수정] ScraperModule 등록
└── package.json                  # [수정] Playwright 의존성 및 start:dev 스크립트
```

---

## ✅ 테스트 정보 (Test Info)
* **동작 확인**:
  1. **로그인 감지**: 수동 로그인 완료 시 즉시 `Login detected!` 로그와 함께 다음 단계로 진행 확인.
  2. **페이지 수집**: 1페이지(20건) 수집 후 2페이지로 자동 이동하여 총 데이터 누적 성공 확인.
  3. **데이터 샘플**: 수집된 JSON 데이터가 서버 콘솔에 샘플(상위 3건)로 정상 출력되는지 확인.
